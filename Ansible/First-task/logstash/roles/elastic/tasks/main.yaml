  - name: Download Elastic Deb Package
    get_url:
      url: https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.13.4-amd64.deb
      dest: /tmp

  - name: Install Elastic Deb Package
    become: yes
    apt:
      deb: /tmp/elasticsearch-7.13.4-amd64.deb
    
  - name: Update Elastic Config (IP Address to 0.0.0.0)
    become: yes
    lineinfile:
      destfile: /etc/elasticsearch/elasticsearch.yml
      regexp: '#network.host: 192.168.0.1'
      line: 'network.host: 0.0.0.0'
    
  - name: Updating Elastic Config (Port Number)
    become: yes
    lineinfile:
      destfile: /etc/elasticsearch/elasticsearch.yml
      regexp: 'http.port'
      line: 'http.port: 9200'
    
  - name: Updating Elastic Config (Node Name)
    become: yes
    lineinfile:
      destfile: /etc/elasticsearch/elasticsearch.yml
      regexp: '#cluster.name: my-application'
      line: 'cluster.name: logstash'
      
  - name: Updating Elastic Config (Cluster Initial Master Nodes)
    become: yes
    lineinfile:
      destfile: /etc/elasticsearch/elasticsearch.yml
      regexp: '#discovery.seed_hosts: ["host1", "host2"]'
      line: 'discovery.seed_hosts: ["127.0.0.1", "[::1]"]'   
     
  - name: Start and Enabled ElasticSearch Service
    become: yes
    service:
      name: elasticsearch
      state: started
      enabled: yes